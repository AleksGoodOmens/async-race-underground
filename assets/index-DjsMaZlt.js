var A=Object.defineProperty;var x=(r,e,t)=>e in r?A(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var o=(r,e,t)=>x(r,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const h of s.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&a(h)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();const i={HOME:"/async-race-underground",GARAGE:"/async-race-underground/garage",WINNERS:"/async-race-underground/winners",NOTFOUND:"/async-race-underground/404"},k={logo:"Async-Race Underground"};class M{constructor(){o(this,"_container");this._container=document.createElement("header"),this.view()}view(){const e=document.createElement("a");e.textContent=k.logo,e.href=i.HOME,this.container.append(e)}get container(){return this._container}}const d={BASE:"http://127.0.0.1:3000",GARAGE:"garage"};async function y(r){try{const e=await fetch(r);if(!e.ok)return{error:e.statusText};const t=await e.json(),a=e.headers.get("X-Total-Count");return a?{data:t,totalAmount:a}:{data:t}}catch(e){return e instanceof Error?{error:e.message}:{error:"something go wrong"}}}class m{constructor(e){o(this,"page");o(this,"_app");this.page=document.createElement("div"),this._app=e}clear(){for(;this._app.main.firstChild;)this._app.main.firstChild.remove();for(;this.page.firstChild;)this.page.firstChild.remove()}}const G={message:"No cars at list"};class L{constructor(){o(this,"_list");this._list=document.createElement("ul")}view(e,t){if(this.clear(),e.length){const a=e.map(n=>{const s=document.createElement("li"),h=document.createElement("h3"),C=document.createElement("div"),p=document.createElement("input"),f=document.createElement("button"),E=document.createElement("button");return h.textContent=n.name,C.style.backgroundColor=n.color,p.type="color",p.value=n.color,f.textContent="update",E.textContent="del",s.append(h,C,p,f,E),s});this._list.append(...a);return}else{const a=document.createElement("h2");a.textContent=t||G.message,this._list.append(a)}}get list(){return this._list}clear(){for(;this._list.lastChild;)this._list.lastChild.remove()}}class g{constructor(e){o(this,"_link");this._link=document.createElement("a"),this.view(e)}view(e){this._link.textContent=e.textContent,this._link.href=e.href,this._link.addEventListener("click",t=>{t.preventDefault(),e.callback()})}get link(){return this._link}}const T=-1,N=1;var _=(r=>(r[r.back=T]="back",r[r.next=N]="next",r))(_||{});const u={back:"<<",next:">>",amount:"1/1",clear:"Clear",ONE:1};class O{constructor(e){o(this,"_container");o(this,"_back");o(this,"_next");o(this,"_amount");o(this,"_changePage");this._container=document.createElement("div"),this._back=document.createElement("button"),this._next=document.createElement("button"),this._amount=document.createElement("div"),this._changePage=e,this.init()}init(){this._back.textContent=u.back,this._next.textContent=u.next,this._amount.textContent=u.amount;const e=document.createElement("button");e.textContent=u.clear,this._back.addEventListener("click",()=>this.changePageHandler(_.back)),this._next.addEventListener("click",()=>this.changePageHandler(_.next)),this._container.append(this._back,this._amount,this._next,e)}changePageHandler(e){this._changePage(e)}update(e){e.currentPage<=u.ONE?this._back.disabled=!0:this._back.disabled=!1,e.currentPage>=e.totalPages?this._next.disabled=!0:this._next.disabled=!1,this._amount.textContent=`${e.currentPage} / ${e.totalPages}`}get htmlElement(){return this._container}}const P={BMW:["M3 GT","X5 M","M4 Coupe","i8","Z4 Roadster","M5 Competition","X7","M2 CS","330i","750Li"],Mercedes:["AMG GT","C63 AMG","E-Class Coupe","S500","GLE Coupe","A45 AMG","GLS 600 Maybach","SLS AMG","CLA 35 AMG","G-Class"],Audi:["RS6 Avant","A7 Sportback","R8 V10","Q8","S3 Sedan","TT RS","SQ5","A4 Allroad","RS Q8","A6 e-tron"],Ford:["Mustang GT","F-150 Raptor","Focus RS","Explorer ST","Bronco","GT","Maverick","Escape","Edge ST","Expedition"],Toyota:["Supra GR","Camry TRD","Land Cruiser","Corolla GR","Hilux","RAV4 Prime","Tacoma TRD Pro","Avalon","Sequoia","C-HR"],Nissan:["GT-R R35","370Z Nismo","Skyline R34","Juke Nismo","Pathfinder","X-Trail","Qashqai","Navara","Murano","Leaf"],Honda:["Civic Type R","NSX","Accord Sport","CR-V Hybrid","S2000","Pilot","Odyssey","Fit","Ridgeline","HR-V"],Chevrolet:["Camaro ZL1","Corvette C8","Silverado","Malibu","Tahoe","Suburban","Blazer","Traverse","Equinox","Colorado"],Porsche:["911 Turbo S","Cayenne Turbo","Panamera GTS","Taycan Turbo","Macan S","718 Cayman GT4","Carrera GT","Boxster GTS","911 Carrera","Macan GTS"],Tesla:["Model S Plaid","Model 3 Performance","Model X","Model Y","Cybertruck","Roadster","Model S Long Range","Model 3 Long Range","Semi","Model Y Standard"],Lamborghini:["Huracan EVO","Aventador SVJ","Urus","Gallardo","Murcielago","Diablo","Reventon","Countach","Sesto Elemento","Centenario"],Ferrari:["SF90 Stradale","F8 Tributo","488 Pista","812 Superfast","LaFerrari","Portofino","GTC4Lusso","Roma","F430","Enzo Ferrari"],Maserati:["MC20","Levante","Ghibli","Quattroporte","GranTurismo","GranCabrio","Alfieri","Biturbo","MC12","Bora"],Jaguar:["F-Type","XF","XJ","E-Pace","F-Pace","I-Pace","XK","XE","XJR","D-Type"],Subaru:["WRX STI","BRZ","Outback","Forester","Legacy","Impreza","Crosstrek","Levorg","Baja","Ascent"]};function w(r,e,t){const a=new URL(e,r);return Object.entries(t).forEach(([n,s])=>{a.searchParams.set(n,String(s))}),a.toString()}const c={title:"Random Cars",label:"Amount",minimum:3,default:100,create:"Create",error:"Something go wrong, car not added",color:{maxHEX:256,hex:16,min:6}};class F{constructor(e){o(this,"_element");o(this,"_amount");o(this,"_updateList");this._element=document.createElement("div"),this._amount=document.createElement("input"),this._updateList=e,this.init()}init(){const e=document.createElement("h2");e.textContent=c.title;const t=document.createElement("label");t.textContent=c.label,this._amount.type="number",this._amount.min=String(c.minimum),this._amount.max=String(c.default+c.default),this._amount.value=String(c.default),t.append(this._amount);const a=document.createElement("button");a.textContent=c.create,a.addEventListener("click",n=>this.createHandler(n)),this._element.append(e,t,a)}async createHandler(e){const t=e.target;if(t instanceof HTMLButtonElement){t.disabled=!0;const a=[];for(let n=0;n<Number.parseInt(this._amount.value);n++)a.push(this.addCar(this.getRandomCar()));await Promise.all(a),this._updateList(),t.disabled=!1}}getRandomCar(){const e=Object.keys(P),t=e[Math.floor(Math.random()*e.length)],a=P[t],n=a[Math.floor(Math.random()*a.length)];return{name:`${t} ${n}`,color:this.getRandomHexColor()}}getRandomHexColor(){return`#${Math.floor(Math.random()*c.color.maxHEX).toString(c.color.hex).padStart(c.color.min,"0")}`}async addCar(e){const t=w(d.BASE,d.GARAGE,{});try{const a=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return a.ok?await a.json():{error:c.error+a.statusText}}catch(a){return a instanceof Error?{error:a.message}:{error:c.error}}}get element(){return this._element}}function b(r,e){const t=new URLSearchParams(window.location.search).get(r);return t?Object.is(Number.parseInt(t),isNaN)?e:Number.parseInt(t):e}const l={title:"Garage",link:"Winners",searchParams:{limit:"_limit",page:"_page"},defaultLimit:7,defaultPage:1};class H extends m{constructor(t){super(t);o(this,"_carList");o(this,"_cars");o(this,"_totalCars");o(this,"_errorMessage");o(this,"_pagination");o(this,"_randomCars");o(this,"_currentPage");this._errorMessage=null,this._cars=[],this._carList=new L,this._pagination=new O(a=>this.changePage(a)),this._randomCars=new F(()=>this.update()),this._totalCars=0,this._currentPage=b(l.searchParams.page,l.defaultPage)}changePage(t){this._currentPage+=t;const a=new URLSearchParams;a.set(l.searchParams.page,String(this._currentPage)),history.pushState(null,"",`${window.location.pathname}?${a.toString()}`),this.update()}async view(){this.clear();const t=document.createElement("h1");t.textContent=l.title;const a=new g({href:i.WINNERS,textContent:l.link,callback:()=>this._app.router.navigate(i.WINNERS)}).link;await this.fetchCars(),this.update(),this.page.append(t,a,this._pagination.htmlElement,this._randomCars.element,this._carList.list),this._app.main.append(this.page)}async fetchCars(){const t=w(d.BASE,d.GARAGE,{[l.searchParams.limit]:b(l.searchParams.limit,l.defaultLimit),[l.searchParams.page]:this._currentPage}),a=await y(t);if("error"in a){this._errorMessage=a.error;return}if(this._cars=a.data,a.totalAmount){const n=Number.parseInt(a.totalAmount);this._totalCars=n}}async update(){await this.fetchCars(),this._carList.view(this._cars,this._errorMessage),this._pagination.update({totalPages:Math.ceil(this._totalCars/l.defaultLimit),currentPage:this._currentPage})}}const S={title:"home",start:"Race"};class B extends m{constructor(e){super(e)}view(){this.clear();const e=document.createElement("h1");e.textContent=S.title;const t=new g({textContent:S.start,href:i.GARAGE,callback:()=>this._app.router.navigate(i.GARAGE)}).link;this.page.append(e,t),this._app.main.append(this.page)}}const R={title:"This page not found",link:"Go to home page"};class X extends m{constructor(e){super(e)}view(){const e=document.createElement("h1");e.textContent=R.title;const t=new g({textContent:R.link,href:i.HOME,callback:()=>this._app.router.navigate(i.HOME)}).link;this.page.append(e,t),this._app.main.append(this.page)}}const v={title:"Winners",link:"Go to the Garage"};class $ extends m{constructor(e){super(e)}view(){this.clear();const e=document.createElement("h1");e.textContent=v.title;const t=new g({textContent:v.link,href:i.GARAGE,callback:()=>this._app.router.navigate(i.GARAGE)}).link;this.page.append(e,t),this._app.main.append(this.page)}}class D{constructor(e){o(this,"_routes");o(this,"_app");this._routes=this.createRoutes(),this._app=e,this.handlePathChange()}navigate(e){history.pushState({},"",e),this.handlePathChange()}createRoutes(){return[{path:i.HOME,page:()=>this._app._homePage.view()},{path:i.GARAGE,page:()=>this._app._garagePage.view()},{path:i.WINNERS,page:()=>this._app._winnersPage.view()},{path:i.NOTFOUND,page:()=>this._app._notFoundPage.view()}]}handlePathChange(){let e=globalThis.location.pathname;e=e.replace(/^\/async-race-underground/,"")||"/";const t=this._routes.find(a=>a.path.replaceAll("/","")===e.replaceAll("/",""));if(!t){this.navigate(i.NOTFOUND);return}t.page()}}class I{constructor(){o(this,"_container");o(this,"_content");o(this,"_homePage");o(this,"_garagePage");o(this,"_winnersPage");o(this,"_notFoundPage");o(this,"router");this._container=document.createElement("div"),this._content=document.createElement("main"),this._homePage=new B(this),this._garagePage=new H(this),this._winnersPage=new $(this),this._notFoundPage=new X(this),this.router=new D(this),this.view()}view(){this._container.append(new M().container,this._content),document.body.append(this._container)}get container(){return this._container}get main(){return this._content}}new I;
